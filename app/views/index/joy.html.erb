<html>
    <head>
      <title>Joy's Timeline</title>
      <meta charset="utf-8">
      <meta name="description" content="TimelineJS example">
      <meta name="apple-mobile-web-app-capable" content="yes">
      <meta name="apple-touch-fullscreen" content="yes">
      <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
      <!-- Style-->
      <style>
          html, body {
              height:100%;
              padding: 0px;
              margin: 0px;
          }
      </style>
      <!-- HTML5 shim, for IE6-8 support of HTML elements--><!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
    </head>
    <body>
    <div id="timeline-embed"></div>
    <script type="text/javascript" src="build/js/dropbox.js"></script>
    <script type="text/javascript">

    </script>
        <script type="text/javascript">
            var client = new Dropbox.Client({
                key: "41e7ki1qabbf2a7",
                secret: "s7mt52bbav64rwn",
                token: "ouIEkUpgbqAAAAAAAAASAel11n0kiwFIXmeO83AXOv-cCMkBWsIXV1NJBBmlXnAq"
            });
            // Try to finish OAuth authorization.
            client.authenticate({interactive: false}, function (error) {
                if (error) {
                    alert('Authentication error: ' + error);
                }
            });

            if (client.isAuthenticated()) {
                // Client is authenticated. Display UI.
            }




          var JOY = {},
              paths,
              events = [];
              thumbOptions = {};

          JOY.paths = "<%=@paths%>";
          paths = JOY.paths.split(',');
          thumbOptions = {
              png: true,
              format:"png",
              size: "l"
          };

            paths.forEach(function(path){

              var link = client.thumbnailUrl(path, thumbOptions);

              var date = link.match(/(\d{4})(-|\/)(\d{2})(-|\/)(\d{2})/)[0].split("-").join(",");
              var event = {
                  'startDate' : date,
                  'endDate' : date,
                  'headline' : '开心的成长',
                  'text' : '',
                  'asset' : {
                      'media' :link,
                      'credit' : '',
                      'caption' : ''
                  }
              };
              events.push(event);
          });

          timelineJson = {
              'timeline' : {
                  'headline' :"Joy's timeline",
                  'type' : 'default',
                  'text' : '记录陈霂嫣成长的点点滴滴',
                  'startDate' : '2014年5月3日',
                  'date' : events
              }
          };

          var timeline_config = {
              width: "100%",
              height: "100%",
              source: timelineJson
          };
        </script>
        <script type="text/javascript" src="build/js/storyjs-embed.js"></script>
    </body>
</html>